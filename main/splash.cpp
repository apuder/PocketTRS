
#include "splash.h"
#include "trs_screen.h"
#include "settings.h"
#include <cstring>


extern const unsigned char splash[1024];

void show_splash()
{
  ScreenBuffer* screenBuffer = new ScreenBuffer(MODE_TEXT_64x16);
  if (settingsSplashScreen.hideSplashScreen()) {
    memset(screenBuffer->getBuffer(), ' ', 1024);
  } else {
    memcpy(screenBuffer->getBuffer(), splash, 1024);
  }
  trs_screen.push(screenBuffer);
  trs_screen.refresh();
}

//----------------------------------------------------------------

static const char* KEY_SPLASH = "hide_splash";

void SettingsSplashScreen::init()
{
  uint8_t flag = nvs_get_u8(KEY_SPLASH);
  hide_splash_screen = (flag != 0);
}

bool SettingsSplashScreen::hideSplashScreen()
{
  return hide_splash_screen;
}

void SettingsSplashScreen::hideSplashScreen(bool hide)
{
  nvs_set_u8(KEY_SPLASH, hide ? 1 : 0);
  hide_splash_screen = hide;
}

SettingsSplashScreen settingsSplashScreen;

//----------------------------------------------------------------

const unsigned char splash[1024] = {
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0xA0, 0xB0, 0xB0, 0xB0, 0xB0, 0xB0, 0xB0,
  0xB0, 0xB0, 0xB0, 0xB0, 0x90, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0xB0, 0xB0, 0xB0, 0xB8,
  0xBC, 0xBC, 0x9C, 0x8C, 0xAC, 0xBC, 0xB7, 0xB3,
  0xBB, 0xBB, 0xBC, 0xBE, 0xBD, 0xBC, 0xBE, 0x8C,
  0x8F, 0xA3, 0xB9, 0xB4, 0xAD, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0xB0, 0xB0, 0xB0, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC,
  0x87, 0xA3, 0xB3, 0xB3, 0xB9, 0x8C, 0x8C, 0x8C,
  0x8E, 0x83, 0x83, 0x83, 0x83, 0x83, 0x81, 0x80,
  0x80, 0x80, 0x80, 0xAF, 0xBF, 0xBD, 0x88, 0xBE,
  0xBF, 0xBF, 0xBF, 0xBF, 0xAA, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF,
  0x90, 0x82, 0xBF, 0x9F, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x82, 0xBF, 0xBF, 0x80, 0xBF,
  0xBF, 0x8F, 0x87, 0xB9, 0x96, 0x94, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0xAA, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF,
  0xB5, 0x80, 0xBF, 0xBD, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0xAB, 0xBF, 0x95, 0xA3,
  0xB8, 0xBC, 0xBF, 0xBF, 0x95, 0xA5, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x82, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF,
  0xBF, 0x90, 0x80, 0xBF, 0x90, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0xBA, 0xBF, 0xBD, 0xAA,
  0xBF, 0xBF, 0xBF, 0x8F, 0x83, 0x8A, 0x90, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0xAB, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF,
  0xBF, 0xB5, 0x80, 0xAB, 0x95, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0xB0, 0xBC, 0xBF, 0xBF, 0x8F, 0x82,
  0x87, 0x81, 0x80, 0xB0, 0xB8, 0xBE, 0xBF, 0xBD,
  0xBC, 0xB4, 0xB0, 0x90, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x82, 0xAF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF,
  0xBF, 0xBF, 0x94, 0x82, 0xBF, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0xB0, 0xB0, 0xB8, 0xBC,
  0x8E, 0x8F, 0x83, 0x83, 0x80, 0x80, 0xB0, 0xB8,
  0xBC, 0xBE, 0xBF, 0xBF, 0xBF, 0x8F, 0xBF, 0xBF,
  0xBF, 0xBF, 0x9B, 0xBF, 0xBF, 0xBC, 0xB4, 0x90,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x8B, 0xAF, 0xBF, 0xBF, 0xBF,
  0xBF, 0xBF, 0xBD, 0x80, 0x9E, 0xBC, 0xBC, 0xBC,
  0xBC, 0xBE, 0x8F, 0x8F, 0x83, 0x83, 0x80, 0x80,
  0xA0, 0xB0, 0xB8, 0xBC, 0xBF, 0xBF, 0xBF, 0xBF,
  0xBF, 0xBF, 0xBF, 0xB3, 0xBC, 0xBF, 0xBF, 0xBF,
  0xBF, 0xBF, 0x9F, 0x8F, 0x83, 0xB1, 0xB8, 0x8E,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x82, 0x8B, 0xBF,
  0xBF, 0xBF, 0xBF, 0x94, 0x80, 0x83, 0x83, 0x83,
  0x80, 0x80, 0x80, 0xB0, 0xB0, 0xBC, 0xBC, 0xBF,
  0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF,
  0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0x8F,
  0x87, 0xA1, 0xB0, 0x9C, 0x87, 0x81, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x83, 0xAF, 0xBF, 0xBD, 0x90, 0x80, 0x80, 0xB0,
  0xB8, 0xBE, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF,
  0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF,
  0xBF, 0xBF, 0xBF, 0x9F, 0x87, 0x83, 0xB0, 0xB8,
  0x8E, 0x83, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x82, 0x8B, 0xAF, 0xBD, 0xB4, 0x82,
  0x8B, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF,
  0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0xBF, 0x9F,
  0x8F, 0x83, 0xA0, 0xB8, 0x8C, 0x87, 0x81, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x83, 0x8F, 0xBF,
  0xBC, 0x90, 0x83, 0x8F, 0xBF, 0xBF, 0xBF, 0xBF,
  0xBF, 0xBF, 0xBF, 0xBF, 0x8F, 0x87, 0xA1, 0xB0,
  0x9C, 0x87, 0x83, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x83, 0x8F, 0xBD, 0xB4, 0x80, 0x8B, 0xAF, 0xBF,
  0x9F, 0x87, 0x83, 0xB0, 0x9C, 0x87, 0x83, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x20, 0x20, 0x20, 0x50,
  0x6F, 0x63, 0x6B, 0x65, 0x74, 0x54, 0x52, 0x53,
  0x20, 0x20, 0x20, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x83, 0x8B, 0xAC, 0x90, 0xA0,
  0xB0, 0x9C, 0x87, 0x81, 0x80, 0x80, 0x80, 0x20,
  0x41, 0x20, 0x4D, 0x6F, 0x64, 0x65, 0x6C, 0x20,
  0x49, 0x49, 0x49, 0x2F, 0x34, 0x20, 0x45, 0x6D,
  0x75, 0x6C, 0x61, 0x74, 0x6F, 0x72, 0x20, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x82, 0x83,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
  0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80
};